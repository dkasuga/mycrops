#include <stdio.h>
#include <stdlib.h>
#include "ip.h"

int 
ip_addr_pton(const char *p, ip_addr_t *n){
    char *sp, *ep;
    int idx;
    long ret;

    sp = (char *)p;
    for(idx = 0; idx<4; idx++){
        ret = strtol(sp, &ep, 10);
        if(ret < 0 || ret > 255){
            return -1;
        }
        if(ep == sp){
            return -1;
        }
        if((idx == 3 && *ep != '\0') || (idx != 3 && *ep != '.')) {
            return -1;
        }
        ((uint8_t *)n)[idx] = ret;
        sp = ep + 1;
    }
    return 0;
}

char *
ip_addr_ntop(const ip_addr_t *n, char *p, size_t size) {
    uint8_t *ptr;
    
    ptr = (uint8_t *)n;
    snprintf(p, size, "%d.%d.%d.%d", ptr[0], ptr[1], ptr[2], ptr[3]);
    return p;
}
